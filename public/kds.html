<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>厨房ディスプレイ</title>
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="POSレジ">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="kds-container">
        <div class="kds-header">調理中</div>
        <div class="kds-grid" id="orders-grid">
            <!-- 注文カードがここに表示される -->
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

    <script src="firebase-config.js"></script>
    <script>
        const ordersGrid = document.getElementById('orders-grid');

        db.collection('orders')
          .where('status', '==', 'processing')
          .orderBy('createdAt', 'asc')
          .onSnapshot(snapshot => {
              ordersGrid.innerHTML = '';
              snapshot.forEach(doc => {
                  const order = doc.data();
                  const orderCard = document.createElement('div');
                  orderCard.className = 'order-card';
                  
                  let itemsHtml = '';
                  order.items.forEach(item => {
                      itemsHtml += `
                          <div class="order-item">
                              <span>${item.name}</span>
                              <strong>x ${item.quantity}</strong>
                          </div>
                      `;
                  });

                  orderCard.innerHTML = `
                      <div class="order-header">
                          <span>#${order.orderNumber}</span>
                          <span>${new Date(order.createdAt?.toDate()).toLocaleTimeString('ja-JP')}</span>
                      </div>
                      <div class="order-items">
                          ${itemsHtml}
                      </div>
                  `;
                  ordersGrid.appendChild(orderCard);
              });
          });
    </script>
</body>
</html>